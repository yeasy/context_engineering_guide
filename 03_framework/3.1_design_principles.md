## 3.1 信息环境设计原则

### 信息环境的概念

**信息环境**（Information Environment）是指模型在执行任务时可获取的全部信息的集合与组织方式。上下文工程的本质就是设计和管理这个信息环境。

一个优秀的信息环境应该满足以下特性：
- 包含任务所需的充分信息
- 排除无关的噪声信息
- 以模型易于理解的方式组织
- 能够动态适应任务需求

### 设计原则一：相关性优先

**核心理念**：只包含与当前任务直接相关的信息。

相关性是上下文质量的首要指标。研究表明，无关信息不仅浪费上下文空间，还可能干扰模型判断，导致输出质量下降。

```mermaid
graph TB
    subgraph "相关性筛选"
        A["全量信息"] --> B{"相关性评估"}
        B --> |"高相关"| C["纳入上下文"]
        B --> |"低相关"| D["排除"]
        B --> |"可能相关"| E["条件纳入"]
    end
```

实践要点：
- 建立任务-信息的映射关系
- 使用语义相似度评估相关性
- 设置相关性阈值，过滤低分内容
- 对于边界情况，宁缺毋滥

### 设计原则二：信息密度优化

**核心理念**：用最少的 Token 传达最多的有效信息。

信息密度定义为：有效信息量与 Token 数量的比值。高密度的上下文意味着：
- 更高的空间利用效率
- 更低的计算成本
- 更快的响应速度

提升信息密度的方法：
- 删除冗余词汇和重复内容
- 使用结构化格式替代散文
- 压缩长文本为摘要
- 提取关键事实而非全文

### 设计原则三：结构化组织

**核心理念**：用清晰的结构组织信息，便于模型理解和定位。

结构化组织的优势：
- 帮助模型快速定位相关信息
- 明确不同信息块的角色和关系
- 减少歧义和误解
- 支持模块化更新和维护

常用的结构化方法：

| 方法 | 适用场景 | 示例 |
|------|----------|------|
| XML 标签 | 区分不同类型内容 | `<instructions>...</instructions>` |
| Markdown | 层级化文档 | 标题、列表、代码块 |
| JSON | 结构化数据 | 配置、元数据 |
| 分隔符 | 简单内容分隔 | `---`、`===` |

### 设计原则四：上下文分层

**核心理念**：根据信息的重要性和稳定性，分层组织上下文。

典型的分层结构：

```mermaid
graph TB
    subgraph "上下文分层"
        A["系统层：角色定义、行为准则"]
        B["知识层：领域知识、参考文档"]
        C["任务层：当前任务的具体要求"]
        D["交互层：对话历史、用户输入"]
    end
    A --> B --> C --> D
```

- **系统层**：最稳定，定义模型的基本角色和行为边界
- **知识层**：相对稳定，提供任务所需的背景知识
- **任务层**：随任务变化，描述当前的具体目标
- **交互层**：最动态，反映即时的用户输入和对话状态

分层的好处：
- 稳定层可以缓存复用
- 动态层独立更新
- 便于调试和维护

### 设计原则五：显式优于隐式

**核心理念**：明确说明期望，而非依赖模型推测。

模型擅长遵循明确的指令，但对隐含期望的推测可能不可靠。因此：

- 明确输出格式要求
- 显式说明限制条件
- 清楚定义术语含义
- 提供具体的正例和反例

### 设计原则六：渐进式提供

**核心理念**：按需提供信息，避免一次性加载全部内容。

这一原则在智能体系统中尤为重要。渐进式提供的方式：

- **即时加载**：在需要时通过工具获取信息
- **分步展开**：随着任务进展逐步添加细节
- **条件触发**：基于特定条件加载相关内容

渐进式方法的优势：
- 避免上下文过载
- 确保信息的时效性
- 降低初始延迟

### 原则的综合应用

这六项原则并非孤立，而是需要综合应用。一个良好的上下文设计应该：

1. 从相关性筛选开始，确定需要包含的信息
2. 对选中的信息进行密度优化
3. 使用合适的结构组织内容
4. 按层级安排信息的位置
5. 显式表达所有重要要求
6. 设计动态加载机制处理变化需求

在实际项目中，可能需要在这些原则之间做出权衡。理解每项原则的目的，有助于在具体场景下做出正确的决策。
